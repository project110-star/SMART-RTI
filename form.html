<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Smart RTI Form — Full</title>

<!-- Backendless SDK -->
<script src="https://unpkg.com/backendless/dist/backendless.min.js"></script>

<style>
  *{box-sizing:border-box;margin:0;padding:0;font-family:Inter, Arial, sans-serif}
  body{background:linear-gradient(135deg,#dff6ff,#f3f7ff);padding:18px;min-height:100vh}
  .wrap{max-width:920px;margin:12px auto;background:#fff;padding:18px;border-radius:12px;box-shadow:0 8px 30px rgba(10,20,40,0.08)}
  .top{display:flex;align-items:center;justify-content:space-between}
  h2{color:#024; margin:6px 0}
  form{margin-top:12px}
  label{font-weight:600;margin-top:10px;display:block;color:#034}
  input,select,textarea,button{width:100%;padding:12px;border-radius:8px;border:1px solid #d0d7e0;font-size:15px;margin-top:8px}
  textarea{min-height:120px;resize:vertical}
  .row{display:flex;gap:12px}
  .col{flex:1}
  .small{width:180px}
  .btn{background:#007BFF;color:#fff;border:none;cursor:pointer;padding:12px;border-radius:8px}
  .btn.secondary{background:#00A86B}
  #liveMsg{white-space:pre-line;color:#b02a37;font-weight:700;margin-top:8px}
  #aiResult{display:none;margin-top:12px;padding:12px;border-radius:8px}
  .ok{background:#e6fbef;color:#0b6b2a}
  .warn{background:#fff3f2;color:#7a221c}
  .captcha-row{display:flex;gap:8px;align-items:center}
  #captchaBox{background:#000;color:#fff;padding:10px 14px;border-radius:8px;font-weight:700;letter-spacing:2px}
  .inline{display:inline-block;width:auto}
  .muted{color:#556;margin-top:6px;font-size:13px}
  @media(max-width:720px){.row{flex-direction:column}}
</style>
</head>
<body>

<div class="wrap">
  <div class="top">
    <h2>Smart RTI Form (Full)</h2>
    <div>
      <button class="btn" onclick="logout()">Logout</button>
    </div>
  </div>

  <form id="rtiForm" onsubmit="return false;">
    <label>Registration No</label>
    <input id="regNo" readonly>

    <div class="row">
      <div class="col">
        <label>State / UT</label>
        <select id="state" required onchange="loadDepartments()">
          <option value="">Select State/UT</option>
        </select>
      </div>
      <div class="col">
        <label>Department</label>
        <select id="department" required onchange="loadSubjectHints()">
          <option value="">Select Department</option>
        </select>
      </div>
    </div>

    <label>RTI Subject / Topic</label>
    <input id="subject" placeholder="Short subject (eg: Road widening at X chowk)" required>

    <label>Your Full Name</label>
    <input id="name" placeholder="Full name" required>

    <div class="row">
      <div class="col">
        <label>Gender</label>
        <select id="gender"><option value="">Select Gender</option><option>Male</option><option>Female</option><option>Other</option></select>
      </div>
      <div class="col small">
        <label>Age</label>
        <input id="age" type="number" min="1" placeholder="Age">
      </div>
    </div>

    <label>Address Line 1 (House / Street)</label>
    <input id="addr1" required>

    <label>Address Line 2 (Locality)</label>
    <input id="addr2">

    <div class="row">
      <div class="col small">
        <label>Pincode</label>
        <input id="pincode" placeholder="Enter pincode" required>
      </div>
      <div class="col">
        <label>Mobile Number</label>
        <input id="mobile" placeholder="Mobile number" required>
      </div>
    </div>

    <label>Email</label>
    <input id="email" type="email" placeholder="Email address" required>

    <label>Detailed RTI Question / Description</label>
    <textarea id="rtiText" placeholder="Write full details..." required></textarea>
    <div class="muted">Tip: Add specifics — location landmark, time, previous complaints (if any).</div>

    <label>Auto Location (GPS)</label>
    <div class="row">
      <input id="geo" readonly placeholder="Click 'Fetch Location' to auto-fill" class="col">
      <button class="btn inline" type="button" onclick="getLocation()">Fetch Location</button>
    </div>

    <label>Photo Proof (recommended)</label>
    <input id="photo" type="file" accept="image/*" capture="camera">

    <div class="captcha-row" style="margin-top:8px">
      <div id="captchaBox"></div>
      <input id="captchaInput" placeholder="Enter Captcha" style="flex:1">
      <button id="captchaRefresh" type="button" class="btn inline">↻</button>
    </div>

    <div id="liveMsg"></div>

    <div style="display:flex;gap:8px;margin-top:10px">
      <button type="button" class="btn" onclick="aiVerifyRTI()">AI Verify Information</button>
      <button type="button" class="btn secondary" onclick="submitRTI()">Submit RTI</button>
    </div>

    <div id="aiResult"></div>
  </form>
</div>

<script>
/* ==================== CONFIG ==================== */
/* Replace with your own Backendless App ID & JS Key if you wish */
const BACKENDLESS_APP_ID = "A1EFA0A2-9F5F-4AB4-B41A-34610BD8119F";
const BACKENDLESS_JS_KEY = "F7F4D0E1-9677-4715-8C0E-F1FD819B9D69";

/* Initialize Backendless */
Backendless.initApp(BACKENDLESS_APP_ID, BACKENDLESS_JS_KEY);

/* ====== PINCODE RANGES (used for validation) ====== */
const PINCODE_RANGE = {
  "Andhra Pradesh": [500000, 539999],
  "Arunachal Pradesh": [790000, 792999],
  "Assam": [780000, 789999],
  "Bihar": [800000, 855999],
  "Chhattisgarh": [490000, 499999],
  "Goa": [403000, 403999],
  "Gujarat": [360000, 396999],
  "Haryana": [121000, 135999],
  "Himachal Pradesh": [171000, 177999],
  "Jharkhand": [814000, 834999],
  "Karnataka": [560000, 591999],
  "Kerala": [670000, 695999],
  "Madhya Pradesh": [450000, 488999],
  "Maharashtra": [400000, 445999],
  "Manipur": [795000, 795999],
  "Meghalaya": [793000, 794999],
  "Mizoram": [796000, 796999],
  "Nagaland": [797000, 798999],
  "Odisha": [750000, 770999],
  "Punjab": [140000, 160999],
  "Rajasthan": [300000, 345999],
  "Sikkim": [737000, 737999],
  "Tamil Nadu": [600000, 643999],
  "Telangana": [500000, 509999],
  "Tripura": [799000, 799999],
  "Uttar Pradesh": [200000, 285999],
  "Uttarakhand": [244000, 263999],
  "West Bengal": [700000, 743999]
};

/* ========== SAMPLE RTI DATASET (state->departments->subject hints) ========== 
   You can replace this with external dataset.js. This inline one ensures form works standalone.
*/
const RTI_DATASET = {
"West Bengal": {
  "Agriculture": [
    "Crop insurance beneficiary list",
    "Fertilizer distribution report",
    "Minimum support price data"
  ],
  "Education": [
    "School teacher vacancy status",
    "Scholarship disbursement details",
    "School infrastructure development"
  ],
  "Health": [
    "Hospital bed availability",
    "Medicine stock records",
    "Doctor appointment status"
  ],
  "Home": [
    "Police FIR statistics",
    "Prisoner welfare information",
    "Disaster response expenditure"
  ],
  "Transport": [
    "Bus depot staff list",
    "Road repair fund usage",
    "Ticketing system audit"
  ],
  "Power": [
    "Electricity outage report",
    "Transformer installation status",
    "Smart meter deployment"
  ],
  "Finance": [
    "Budget allocation records",
    "Tax collection statement",
    "Audit department expenditure"
  ],
  "Water Supply": [
    "Pipeline repair status",
    "Water quality test results",
    "Daily water supply schedule"
  ],
  "Industry": [
    "Industrial licenses issued",
    "Factory inspection reports",
    "Industrial land allotment"
  ],
  "Rural Development": [
    "MGNREGA payment details",
    "Road construction progress",
    "Village-level beneficiary list"
  ],
  "Urban Development": [
    "Municipal tax collection",
    "Drainage cleaning schedule",
    "Smart city expenditure"
  ],
  "Women & Child Welfare": [
    "Anganwadi food supply",
    "Women helpline calls",
    "Child protection cases"
  ],
  "Social Justice": [
    "Caste certificate issuance",
    "Welfare pension list",
    "Disabled student support"
  ],
  "Minority Affairs": [
    "Scholarship fund usage",
    "Minority housing scheme",
    "Educational grant list"
  ],
  "Forest": [
    "Tree plantation records",
    "Forest land encroachment",
    "Wildlife protection cases"
  ],
  "Revenue": [
    "Land mutation status",
    "Property tax collection",
    "Land record digitization"
  ],
  "Tourism": [
    "Tourist footfall statistics",
    "Hotel classification details",
    "Tourism promotion budget"
  ],
  "Labour": [
    "Minimum wage revision",
    "Labour license data",
    "Accident compensation cases"
  ],
  "Food & Civil Supplies": [
    "Ration card list",
    "PDS shop inspection report",
    "Food grain allocation"
  ],
  "Public Works": [
    "Bridge construction status",
    "Highway repair report",
    "Project tender information"
  ]
  
},
"Odisha": {
  "Agriculture": [
    "Paddy procurement status",
    "Fertilizer stock report",
    "Crop damage compensation list"
  ],
  "Education": [
    "School teacher attendance",
    "Hostel facility report",
    "Scholarship disbursement"
  ],
  "Health": [
    "PHC staff list",
    "Medicine purchase record",
    "Ambulance availability"
  ],
  "Home": [
    "Cyclone relief expenditure",
    "Police station functioning",
    "Prisoner health records"
  ],
  "Transport": [
    "Bus route permit list",
    "Road accident report",
    "Highway toll collection"
  ],
  "Power": [
    "Village electrification",
    "Transformer maintenance",
    "Electricity billing audit"
  ],
  "Finance": [
    "GST collection data",
    "Budget expense report",
    "Audit objections list"
  ],
  "Water Supply": [
    "Rural water tank cleaning",
    "Pipeline leakage report",
    "Handpump repair status"
  ],
  "Industry": [
    "Industrial policy subsidy",
    "Mine safety reports",
    "Industrial pollution checks"
  ],
  "Rural Development": [
    "MGNREGA muster roll",
    "Rural housing list",
    "Village sanitation plan"
  ],
  "Urban Development": [
    "Smart city project cost",
    "Municipal garbage collection",
    "Streetlight maintenance"
  ],
  "Women & Child Welfare": [
    "Malnutrition cases",
    "Anganwadi worker list",
    "Shelter home audit"
  ],
  "Social Justice": [
    "SC/ST scholarship list",
    "Pension beneficiary data",
    "Welfare fund usage"
  ],
  "Minority Affairs": [
    "Hostel facility for minorities",
    "Scholarship distribution",
    "Skill development report"
  ],
  "Forest": [
    "Forest fire report",
    "Tree plantation map",
    "Wildlife permit issuance"
  ],
  "Revenue": [
    "Encroachment cases",
    "Land registration data",
    "Tax collection report"
  ],
  "Tourism": [
    "Temple tourism statistics",
    "Hotel license list",
    "Tourism project expenditure"
  ],
  "Labour": [
    "Contract labour details",
    "ESI benefits records",
    "Labour welfare inspections"
  ],
  "Food & Civil Supplies": [
    "PDS ration distribution",
    "Food storage inspection",
    "Ration card verification"
  ],
  "Public Works": [
    "Road construction audit",
    "Bridge safety inspection",
    "Tender document records"
  ]
  },
  
  "Bihar": {
  "Agriculture": [
    "Irrigation canal maintenance",
    "Seed distribution list",
    "Crop failure compensation"
  ],
  "Education": [
    "Teacher attendance report",
    "School building condition",
    "Scholarship distribution data"
  ],
  "Health": [
    "PHC doctor availability",
    "Vaccine stock details",
    "Ambulance response time"
  ],
  "Home": [
    "Police station staff list",
    "Crime statistics",
    "Flood relief fund usage"
  ],
  "Transport": [
    "Road widening project",
    "Bus permit issuance",
    "Railway crossing safety"
  ],
  "Power": [
    "Electricity theft cases",
    "Transformer installation",
    "Village electrification list"
  ],
  "Finance": [
    "Tax collection records",
    "Budget usage report",
    "Audit department findings"
  ],
  "Water Supply": [
    "Handpump installation",
    "Water tank maintenance",
    "Water quality testing"
  ],
  "Industry": [
    "Factory inspection reports",
    "Industrial area allocation",
    "Pollution control details"
  ],
  "Rural Development": [
    "MGNREGA payments",
    "Panchayat road status",
    "Rural housing list"
  ],
  "Urban Development": [
    "Drainage cleaning schedule",
    "Municipal tax records",
    "City sanitation plan"
  ],
  "Women & Child Welfare": [
    "ICDS food supply",
    "Women safety helpline",
    "Child adoption records"
  ],
  "Social Justice": [
    "SC/ST loan scheme list",
    "Pension beneficiary status",
    "Caste certificate data"
  ],
  "Minority Affairs": [
    "Hostel facility for minorities",
    "Scholarship list",
    "Skill training records"
  ],
  "Forest": [
    "Forest land survey",
    "Illegal logging cases",
    "Wildlife rescue cases"
  ],
  "Revenue": [
    "Land dispute cases",
    "Tax arrear details",
    "Registry office records"
  ],
  "Tourism": [
    "Tourist spot development",
    "Hotel license renewal",
    "Tourist safety report"
  ],
  "Labour": [
    "Labour accident cases",
    "Employment card issuance",
    "Wage payment records"
  ],
  "Food & Civil Supplies": [
    "Ration shop inspection",
    "PDS stock report",
    "Ration card verification"
  ],
  "Public Works": [
    "Bridge construction audit",
    "Road repair schedule",
    "Tender documents"
  ]
},

"Jharkhand": {
  "Agriculture": [
    "Fertilizer availability",
    "Rainwater harvesting status",
    "Crop insurance claims"
  ],
  "Education": [
    "School attendance records",
    "Scholarship distribution",
    "Hostel facility audit"
  ],
  "Health": [
    "Hospital staff vacancy",
    "Ambulance service data",
    "Medicine purchase report"
  ],
  "Home": [
    "Police station manpower",
    "Naxal-affected area report",
    "Disaster management fund"
  ],
  "Transport": [
    "Road repair progress",
    "Vehicle registration data",
    "Bus permit allocation"
  ],
  "Power": [
    "Power outage hours",
    "Electricity bill audit",
    "Transmission line safety"
  ],
  "Finance": [
    "Budget expenditure list",
    "GST collection report",
    "Audit objections"
  ],
  "Water Supply": [
    "Handpump repair list",
    "Water tanker usage",
    "Pipeline leakage report"
  ],
  "Industry": [
    "Mining lease details",
    "Pollution monitoring",
    "Industrial project status"
  ],
  "Rural Development": [
    "MGNREGA job card list",
    "Village road construction",
    "PM Awas Yojana data"
  ],
  "Urban Development": [
    "Garbage collection schedule",
    "Streetlight maintenance",
    "Municipal water supply"
  ],
  "Women & Child Welfare": [
    "Anganwadi building status",
    "Women helpline calls",
    "Nutrition program audit"
  ],
  "Social Justice": [
    "Pension scheme status",
    "SC/ST development funds",
    "Caste certificate list"
  ],
  "Minority Affairs": [
    "Skill training attendance",
    "Scholarship records",
    "Minority housing scheme"
  ],
  "Forest": [
    "Forest fire cases",
    "Elephant corridor map",
    "Illegal mining activity"
  ],
  "Revenue": [
    "Land record digitization",
    "Mutation status",
    "Tax collection list"
  ],
  "Tourism": [
    "Tourist count report",
    "Hotel registration list",
    "Tourism marketing expenses"
  ],
  "Labour": [
    "Minimum wage list",
    "ESI registers",
    "Labour accident claims"
  ],
  "Food & Civil Supplies": [
    "Ration distribution record",
    "Warehouse inspection",
    "Food grain allocation"
  ],
  "Public Works": [
    "Road tender list",
    "Bridge construction plan",
    "Panchayat building status"
  ]
},

"Uttar Pradesh": {
  "Agriculture": [
    "Sugarcane farmer dues",
    "Agricultural subsidy list",
    "Pesticide quality inspection"
  ],
  "Education": [
    "Teacher posting list",
    "Mid-day meal expenditure",
    "School safety audit"
  ],
  "Health": [
    "District hospital staff list",
    "Medicine stock report",
    "Ambulance response details"
  ],
  "Home": [
    "Police FIR register",
    "Women's safety cases",
    "Disaster relief distribution"
  ],
  "Transport": [
    "Metro project progress",
    "Bus permit status",
    "Highway toll collection"
  ],
  "Power": [
    "Transformer failure report",
    "Electricity billing audit",
    "Rural electrification"
  ],
  "Finance": [
    "Department expenditure",
    "Income tax collection",
    "Audit objections"
  ],
  "Water Supply": [
    "Ganga cleaning project",
    "Pipeline maintenance",
    "Water quality report"
  ],
  "Industry": [
    "Industrial area pollution",
    "Factory licenses issued",
    "Startup policy beneficiaries"
  ],
  "Rural Development": [
    "Village road projects",
    "MGNREGA worker list",
    "Housing scheme progress"
  ],
  "Urban Development": [
    "Smart city fund usage",
    "Sewage cleaning schedule",
    "Property tax collection"
  ],
  "Women & Child Welfare": [
    "Anganwadi center list",
    "Women helpline calls",
    "Child nutrition survey"
  ],
  "Social Justice": [
    "OBC/SC scholarship list",
    "Pension beneficiary details",
    "Welfare scheme audit"
  ],
  "Minority Affairs": [
    "Minority scholarships",
    "Hostel facility report",
    "Training program data"
  ],
  "Forest": [
    "Tree plantation record",
    "Wildlife protection report",
    "Forest land dispute"
  ],
  "Revenue": [
    "Land map digitization",
    "Mutation cases",
    "Tax collection report"
  ],
  "Tourism": [
    "Ayodhya tourism data",
    "Hotel registration",
    "Tourist safety details"
  ],
  "Labour": [
    "Labour welfare fund usage",
    "Accident compensation",
    "Minimum wage list"
  ],
  "Food & Civil Supplies": [
    "Ration shop list",
    "PDS distribution",
    "Warehouse inspection"
  ],
  "Public Works": [
    "Highway construction status",
    "Bridge safety audit",
    "Road tender list"
  ]
},


"Uttarakhand": {
  "Agriculture": [
    "Hill farming subsidy list",
    "Organic farming beneficiaries",
    "Seed distribution"
  ],
  "Education": [
    "School building repair",
    "Teacher transfer list",
    "Scholarship audit"
  ],
  "Health": [
    "PHC doctor shortage",
    "Medicine supply list",
    "Ambulance availability"
  ],
  "Home": [
    "Disaster management cost",
    "Forest fire emergency",
    "Police station data"
  ],
  "Transport": [
    "Hill road repair",
    "Bus permit issuance",
    "Taxi registration list"
  ],
  "Power": [
    "Hydropower plant audit",
    "Transformer maintenance",
    "Electricity usage"
  ],
  "Finance": [
    "Budget allocation",
    "Audit report",
    "Tax receipt details"
  ],
  "Water Supply": [
    "Mountain water project",
    "Pipeline leakage",
    "Water testing reports"
  ],
  "Industry": [
    "Industrial pollution data",
    "Industrial licenses",
    "Factory worker count"
  ],
  "Rural Development": [
    "Village road project",
    "Housing scheme list",
    "MGNREGA job card"
  ],
  "Urban Development": [
    "Municipal waste audit",
    "Streetlight repairs",
    "Property tax report"
  ],
  "Women & Child Welfare": [
    "Anganwadi survey",
    "Women helpline records",
    "Child care home audit"
  ],
  "Social Justice": [
    "Welfare pension list",
    "SC/ST scholarship",
    "Caste certificate list"
  ],
  "Minority Affairs": [
    "Scholarship list",
    "Minority hostel",
    "Training attendance"
  ],
  "Forest": [
    "Forest fire data",
    "Tree plantation list",
    "Wildlife rescue"
  ],
  "Revenue": [
    "Land record digitization",
    "Tax collection report",
    "Mutation status"
  ],
  "Tourism": [
    "Char Dham visitor data",
    "Hotel permits",
    "Tourist safety audit"
  ],
  "Labour": [
    "Labour welfare records",
    "Minimum wage list",
    "ESI register"
  ],
  "Food & Civil Supplies": [
    "PDS food distribution",
    "Ration card list",
    "Warehouse inspection"
  ],
  "Public Works": [
    "Hill highway construction",
 